"use strict";(self.webpackChunkwlx_docs=self.webpackChunkwlx_docs||[]).push([[3216],{2624:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>r,default:()=>h,frontMatter:()=>i,metadata:()=>l,toc:()=>c});var s=t(17624),a=t(4552);const i={sidebar_position:4},r=void 0,l={id:"frontend/Cell types/Javascript",title:"Javascript",description:"Try to evaluate",source:"@site/docs/frontend/Cell types/Javascript.md",sourceDirName:"frontend/Cell types",slug:"/frontend/Cell types/Javascript",permalink:"/frontend/Cell types/Javascript",draft:!1,unlisted:!1,tags:[],version:"current",lastUpdatedAt:1712600483,formattedLastUpdatedAt:"Apr 8, 2024",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"HTML",permalink:"/frontend/Cell types/HTML"},next:{title:"Files",permalink:"/frontend/Cell types/Files"}},o={},c=[{value:"Output cell",id:"output-cell",level:2},{value:"Handlers",id:"handlers",level:2},{value:"this.ondestroy",id:"thisondestroy",level:3},{value:"requestAnimationFrame",id:"requestanimationframe",level:3},{value:"Communication with Wolfram Kernel",id:"communication-with-wolfram-kernel",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",img:"img",p:"p",pre:"pre",strong:"strong",...(0,a.M)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.p,{children:"Try to evaluate"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",metastring:'title="cell"',children:".js\nreturn 1+1\n"})}),"\n",(0,s.jsx)(n.p,{children:"or"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:".js\nconst dom = document.createElement('span');\ndom.innerText = \"Hello World\";\ndom.style.color = 'lightblue';\n\nreturn dom;\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.a,{href:"https://github.com/JerryI/wljs-js-support",children:"Github repo"})}),"\nJavascript code is evaluated as a module, i.e. ",(0,s.jsx)(n.strong,{children:"all defined variables are isolated to the cell"}),"."]}),"\n",(0,s.jsxs)(n.admonition,{type:"tip",children:[(0,s.jsxs)(n.p,{children:["To define global variables, use ",(0,s.jsx)(n.code,{children:"window"})," or ",(0,s.jsx)(n.code,{children:"core"})," object."]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"window.variable = 1\n"})})]}),"\n",(0,s.jsx)(n.h2,{id:"output-cell",children:"Output cell"}),"\n",(0,s.jsx)(n.p,{children:"The returned value from the function can be a Javascript object or DOM element. The last one will be displayed in the output cell"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:".js\nconst canvas = document.createElement('canvas');\nvar ctx = canvas.getContext('2d');\n\ncanvas.width = 500;\ncanvas.height = 500;\n\n\nconst ballRadius = 10;\nlet x = canvas.width / 2;\nlet y = canvas.height - 30;\nlet dx = 2;\nlet dy = -2;\n\nfunction drawBall() {\n  ctx.beginPath();\n  ctx.arc(x, y, ballRadius, 0, Math.PI * 2);\n  ctx.fillStyle = \"#0095DD\";\n  ctx.fill();\n  ctx.closePath();\n}\n\nfunction draw() {\n  ctx.clearRect(0, 0, canvas.width, canvas.height);\n  drawBall();\n\n  if (x + dx > canvas.width - ballRadius || x + dx < ballRadius) {\n    dx = -dx;\n  }\n  if (y + dy > canvas.height - ballRadius || y + dy < ballRadius) {\n    dy = -dy;\n  }\n\n  x += dx;\n  y += dy;\n}\n\nconst interval = setInterval(draw, 10);\n\nthis.ondestroy = () => {\n\tcancelInterval(interval);\n}\n\n\n\nreturn canvas;\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:t(76892).c+"",width:"1090",height:"1020"})}),"\n",(0,s.jsx)(n.h2,{id:"handlers",children:"Handlers"}),"\n",(0,s.jsx)(n.p,{children:"There is a few quite useful built-in objects accesible from the cell."}),"\n",(0,s.jsx)(n.h3,{id:"thisondestroy",children:"this.ondestroy"}),"\n",(0,s.jsx)(n.p,{children:"This object is called when a cell has been destroyed. Assign any clean-up function to the given object"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"this.ondestroy = () => {\n\t//clean up the stuff\n}\n"})}),"\n",(0,s.jsx)(n.admonition,{type:"danger",children:(0,s.jsxs)(n.p,{children:["Always clean up any timers using ",(0,s.jsx)(n.code,{children:"this.ondestroy"})," variable. Otherwise those timers and animation loops will continue to work even after reevaluating the cell."]})}),"\n",(0,s.jsx)(n.h3,{id:"requestanimationframe",children:"requestAnimationFrame"}),"\n",(0,s.jsx)(n.p,{children:"It is well-common method used in Javascript to synchronize with a framerate of the browser and render some graphics"}),"\n",(0,s.jsx)(n.admonition,{type:"danger",children:(0,s.jsxs)(n.p,{children:["Do not forget to ",(0,s.jsx)(n.code,{children:"cancelAnimationFrame"})," using ",(0,s.jsx)(n.code,{children:"this.ondestroy"})," method"]})}),"\n",(0,s.jsx)(n.h2,{id:"communication-with-wolfram-kernel",children:"Communication with Wolfram Kernel"}),"\n",(0,s.jsxs)(n.p,{children:["In general one can define any function for WLJS Interpreter using Javascript cells, please see guide here ",(0,s.jsx)(n.a,{href:"/frontend/Reference/Frontend%20IO/FrontSubmit",children:"FrontSubmit"})," and ",(0,s.jsx)(n.a,{href:"/frontend/Advanced/Events%20system/event-generators#Integration%20with%20server%20/%20client%20via%20WebSockets",children:"Integration with server / client via WebSockets"})]}),"\n",(0,s.jsxs)(n.p,{children:["Also see ",(0,s.jsx)(n.a,{href:"/frontend/Advanced/Javascript/Communication",children:"Communication"})]}),"\n",(0,s.jsxs)(n.p,{children:["For the most applications event-based system is used, see ",(0,s.jsx)(n.a,{href:"/frontend/Dynamics",children:"Dynamics"})]})]})}function h(e={}){const{wrapper:n}={...(0,a.M)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},76892:(e,n,t)=>{t.d(n,{c:()=>s});const s=t.p+"assets/images/Balls-ezgif.com-video-to-apng-converter-0b1b473089b374b3be96a2105a42e9b5.png"},4552:(e,n,t)=>{t.d(n,{I:()=>l,M:()=>r});var s=t(11504);const a={},i=s.createContext(a);function r(e){const n=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);