"use strict";(self.webpackChunkwlx_docs=self.webpackChunkwlx_docs||[]).push([[2912],{11608:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>p,frontMatter:()=>o,metadata:()=>l,toc:()=>d});var r=t(17624),a=t(4552),i=t(19920);const o={sidebar_position:4},s="Meta markers",l={id:"interpreter/Advanced/meta-markers",title:"Meta markers",description:"You can think about them as a unique property assigned to the expression in order to use selectors on them. Sometimes it comes handy to attach or evaluate new object inside the existing instance",source:"@site/docs/interpreter/Advanced/meta-markers.md",sourceDirName:"interpreter/Advanced",slug:"/interpreter/Advanced/meta-markers",permalink:"/interpreter/Advanced/meta-markers",draft:!1,unlisted:!1,tags:[],version:"current",lastUpdatedAt:1710356381e3,sidebarPosition:4,frontMatter:{sidebar_position:4}},c={},d=[{value:"\ud83c\udfa1 Example",id:"-example",level:3}];function h(e){const n={code:"code",h1:"h1",h3:"h3",p:"p",pre:"pre",...(0,a.M)(),...e.components},{Details:t}=n;return t||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{id:"meta-markers",children:"Meta markers"}),"\n",(0,r.jsx)(n.p,{children:"You can think about them as a unique property assigned to the expression in order to use selectors on them. Sometimes it comes handy to attach or evaluate new object inside the existing instance"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-mathematica",children:'FrontEndVirtual[{\n\t(* attach a dom element to draw *)\n    AttachDOM["canvas"], \n    (* mark this instance by uid *)\n    Graphics[{PointSize[0.02], MetaMarker["plot"]}] \n}]; \n'})}),"\n",(0,r.jsxs)(n.p,{children:["Here we marked this instance and ",(0,r.jsx)(n.code,{children:"{}"})," scope with ",(0,r.jsx)(n.code,{children:"plot"})," marker. Then, one can evaluate an arbitrary function on the place of this marker using ",(0,r.jsx)(n.code,{children:"FrontSubmit"})," expression"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-mathematica",children:'FrontSubmit[Point[RandomReal[{- 1,1}, 2]], MetaMarker["plot"]]\n'})}),"\n",(0,r.jsx)(n.p,{children:"Then, a point will appear on the corresponding place. Repeating this process over and over we can populate with any graphical object our existing plot even with dynamic binding."}),"\n",(0,r.jsx)(n.h3,{id:"-example",children:"\ud83c\udfa1 Example"}),"\n",(0,r.jsx)(n.p,{children:"Lets draw some random lines, where each line has a dynamic variable, that specifies the beginning, while the end will be a random fixed value"}),"\n",(0,r.jsxs)(t,{children:[(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-mathematica",children:'(* to be able to animate we need a container *)\nFrontEndVirtual[{\n\t(* attach a dom element to draw *)\n    AttachDOM["canvas"], \n    (* mark this instance by uid *)\n    Graphics[{PointSize[0.02], MetaMarker["plot"]}] \n}];     \n\nj = 0; \n(* now we can directly inject new points into already existing object *)\nlast = {0,0};\n\nWhile[j < 300,         \n With[{try = RandomReal[{- 1,1}, 2]},    \n  FrontSubmit[{\n    RGBColor[RandomSample[{{1,0,0}, {0,1,1}, {1,0,1}}]//First],    \n    Line[{last, try}]\n  }, MetaMarker["plot"]];  \n \n  last = try;  \n ];   \n  \n Pause[0.5];\n j = j + 1;\n]; \n'})}),(0,r.jsxs)(n.p,{children:["As one can see, an expression inside ",(0,r.jsx)(n.code,{children:"Placed"})," will be evaluated inside the instance found by the meta-marker. ",(0,r.jsx)(n.code,{children:"last"})," variable is global, therefore it causes a dynamic update of all added lines."]})]}),"\n",(0,r.jsx)(n.p,{children:"This will lead to the following results"}),"\n","\n",(0,r.jsx)(i.c,{code:"('wls!'%25to%20be%20able%20to%20animate%20we%20need%20a%20containerf%26%5B(7%5Ct%25attach%20a%20dom%20element%20to%20drawf66AttachDOM%5B%5C'canvas%5C'qY66%25mark%20this%20instance%20by%20uidf66G%5E%5B(PointSize%5B0.02q%20Z)%5DY)%2466Y7jN0%3BY%25now%20we%20can%20directly%20inject%20new%20points%20into%20already%20existing%20objectfmTNFindZ%60%3B7lastN(0_)%3B77While%5Bj%20%3C%20500%2C6666Y%20With%5B(tryN%3FReal%5B(-%201X)%3E2%5D)%2C66Y6Placed%5B(766RGBColor%5B%3FSample%5B(%20(0XX)%3E(1_X))%5D%60q66766Line%5B(last%3Etry)%5DY6)%3EmT%2467Y6lastNtry%3B67%20%246Y67%20Pause%5B1%247%20jNj%20%2B%201%3B7%24Y%20'~js!''~includes!%5B'9g%5E-d3%7Fdist%2Fkernel.js'~9interpreter%7Fsrc%2FmetamTs.js'%5D~compiled!%5B'Hold'Q%26'K4AttachDOM'~%22canvas%22'%5D4G%5E'K4PointSize'_.02%5D4%238Uj'_UmT'4First'4Find%23Ulast'K__84While'4Less'~j'%2C500%5DQWith'K4Se%7C4%3FReal'K%2C-1Xq28%5DQPlaced'K4RGBColor'4First'4%3FSample'KK_XX%5DKX_X88%5D4Line'K~las%7C8%5D~mT'Ulas%7Cqnull84Pause'XUj'4Plus'~j'X8%2Cnull8%2Cnull8)4%2C%5B'6%20Y%5Cn8%5D%5D9https%3A%2F%2Fcdn.jsdelivr.net%2Fgh%2FJerryI%2Fwljs-K4List'N%20%3D%20Q4CompoundExpression'4TarkerU%5D4Set'~X%2C1Y%207ZMetaMT%5B%5C'plot%5C'%5D_%2C0f%20*%7D7q%5D%2C%23MetaMT'~%22plot%22'8%24%5D%3B%25%7B*%20%26FrontEndVirtual%3E%2C%20%3FRandom%5Eraphics%60%2F%2FFirst%7Ct'~try'%7F%40main%2F%01%7F%7C%60%5E%3F%3E%26%25%24%23qf_ZYXUTQNK98764_",height:"500",children:"Metaexample"})]})}function p(e={}){const{wrapper:n}={...(0,a.M)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},19920:(e,n,t)=>{t.d(n,{c:()=>s});var r=t(11504);const a={crush:(e,n=50)=>{let t=[];const r="-_.!~*'()";for(let i=127;--i;)(i>=48&&i<=57||i>=65&&i<=90||i>=97&&i<=122||r.includes(String.fromCharCode(i)))&&t.push(String.fromCharCode(i));for(let i=32;i<255;++i){let e=String.fromCharCode(i);"\\"==e||t.includes(e)||t.unshift(e)}e=e.replace(new RegExp("\x01","g"),"");const a=((e,t)=>{let r=t.length,a="";const i=e=>encodeURI(encodeURIComponent(e)).replace(/%../g,"i").length,o=e=>{let n=e.charCodeAt(0),t=e.charCodeAt(e.length-1);return n>=56320&&n<=57343||t>=55296&&t<=56319};let s={};for(let l=2;l<n;l++)for(let n=0;n<e.length-l;++n){let t=e.substr(n,l);if(s[t])continue;if(o(t))continue;let r=1;for(let a=e.indexOf(t,n+l);a>=0;++r)a=e.indexOf(t,a+l);r>1&&(s[t]=r)}for(;;){for(;r--&&e.includes(t[r]););if(r<0)break;let n,o=t[r],l=0,c=i(o);for(let e in s){let t=s[e],r=(t-1)*i(e)-(t+1)*c;a.length||(r-=i("\x01")),r<=0?delete s[e]:r>l&&(n=e,l=r)}if(!n)break;e=e.split(n).join(o)+o+n,a=o+a;let d={};for(let t in s){let r=t.split(n).join(o),a=0;for(let n=e.indexOf(r);n>=0;++a)n=e.indexOf(r,n+r.length);a>1&&(d[r]=a)}s=d}return{a:e,b:a}})(e=i(e),t);let o=a.a;return a.b.length&&(o+="\x01"+a.b),o+="_",o},uncrush:e=>{const n=(e=e.substring(0,e.length-1)).split("\x01");let t=n[0];if(n.length>1){let e=n[1];for(let n of e){let e=t.split(n);t=e.join(e.pop())}}return i(t,0)}},i=(e,n=1)=>{const t=[['"',"'"],["':","!"],[",'","~"],["}",")","\\","\\"],["{","(","\\","\\"]],r=(e,n)=>{let t=new RegExp(`${(n[2]?n[2]:"")+n[0]}|${(n[3]?n[3]:"")+n[1]}`,"g");return e.replace(t,(e=>e===n[0]?n[1]:n[0]))};if(n)for(let a=0;a<t.length;++a)e=r(e,t[a]);else for(let a=t.length;a--;)e=r(e,t[a]);return e};var o=t(17624);function s(e){let{children:n,code:t,width:i,height:s}=e;(0,r.useRef)();const l=JSON.parse(a.uncrush(decodeURIComponent(t))),c=l.js,d=l.compiled,h=`<html>\n  <head>  \n\n    <script>             \n    function isElement(o){\n      return (\n        typeof HTMLElement === "object" ? o instanceof HTMLElement : //DOM2\n        o && typeof o === "object" && o !== null && o.nodeType === 1 && typeof o.nodeName==="string"\n    );\n    }\n    <\/script>\n \n  </head>\n  <body>\n    <div id="canvas" style="text-align:center"></div>\n\n    \n    <script type="module" src="https://cdn.jsdelivr.net/gh/JerryI/wljs-interpreter@main/dist/interpreter.js"><\/script>\n    <script type="module" src="https://cdn.jsdelivr.net/gh/JerryI/wljs-interpreter@main/dist/core.js"><\/script>\n\n    ${(l.includes||[]).map((e=>`<script type="module" src="${e}"><\/script>`)).join("")}\n    \n\n    <script type="module">\n    console.log('start');\n      let global = {};\n      let env = {global: global};\n\n\n        const $f = async () => {\n          ${c}\n        };\n\n        const r = await $f();\n\n        console.log('js');\n\n        if (isElement(r)) {\n          document.getElementById('canvas').appendChild(r);\n        } else {\n          console.log(r);\n        }\n        console.log('op');\n        await interpretate(${JSON.stringify(d)}, env);\n        console.log('ok');\n\n\n    <\/script>\n  </body>\n  </html>`;return(0,o.jsx)("iframe",{width:i||"100%",height:s||"auto",srcDoc:h})}},4552:(e,n,t)=>{t.d(n,{I:()=>s,M:()=>o});var r=t(11504);const a={},i=r.createContext(a);function o(e){const n=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:o(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);