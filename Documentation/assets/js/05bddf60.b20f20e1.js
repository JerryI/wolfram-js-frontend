"use strict";(self.webpackChunkwlx_docs=self.webpackChunkwlx_docs||[]).push([[4976],{92700:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>h,frontMatter:()=>i,metadata:()=>o,toc:()=>d});var a=t(17624),r=t(4552);const i={},s=void 0,o={id:"frontend/Advanced/Syntax sugar/Decorating symbols",title:"Decorating symbols",description:"Giving a rich visual representation to a symbol while programming elevates the whole user experience to another level. There is couple of ways on how to do it in WLJS Notebook.",source:"@site/docs/frontend/Advanced/Syntax sugar/Decorating symbols.md",sourceDirName:"frontend/Advanced/Syntax sugar",slug:"/frontend/Advanced/Syntax sugar/Decorating symbols",permalink:"/frontend/Advanced/Syntax sugar/Decorating symbols",draft:!1,unlisted:!1,tags:[],version:"current",lastUpdatedAt:1716132984e3,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Packages",permalink:"/frontend/Advanced/Packages"},next:{title:"Exporting formats",permalink:"/category/exporting-formats"}},c={},d=[{value:"Temporal",id:"temporal",level:2},{value:"Examples in action",id:"examples-in-action",level:3},{value:"Using Javascript",id:"using-javascript",level:3},{value:"Magic joystick",id:"magic-joystick",level:3},{value:"Permanent",id:"permanent",level:2},{value:"InterpretationBox",id:"interpretationbox",level:3},{value:"Morse code",id:"morse-code",level:4},{value:"MD5 representation",id:"md5-representation",level:4},{value:"ArrangeSummaryBox",id:"arrangesummarybox",level:3},{value:"ViewBox",id:"viewbox",level:3},{value:"Simple example",id:"simple-example",level:4},{value:"External decorators",id:"external-decorators",level:4},{value:"Deferred",id:"deferred",level:2},{value:"State preservation",id:"state-preservation",level:3}];function l(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",img:"img",p:"p",pre:"pre",strong:"strong",...(0,r.M)(),...e.components},{Details:i}=n;return i||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.p,{children:"Giving a rich visual representation to a symbol while programming elevates the whole user experience to another level. There is couple of ways on how to do it in WLJS Notebook."}),"\n",(0,a.jsx)(n.admonition,{type:"info",children:(0,a.jsxs)(n.p,{children:["Read about syntax sugar also in ",(0,a.jsx)(n.a,{href:"/frontend/Symbolic%20programming",children:"Symbolic programming"})]})}),"\n",(0,a.jsx)(n.h2,{id:"temporal",children:"Temporal"}),"\n",(0,a.jsxs)(n.p,{children:["One can replace a symbol with an icon by applying ",(0,a.jsx)(n.a,{href:"/frontend/Reference/Decorations/Interpretation",children:"Interpretation"}),". After first evaluation the representation is lost and the true expression will be revealed"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-mathematica",children:"Interpretation[Graphics[Circle[], ImageSize->{20,20}, ImagePadding->None], 1]\n"})}),"\n",(0,a.jsx)(n.p,{children:"The result is a circle symbol, which can be copied multiple times in any cell"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{src:t(85080).c+"",width:"1044",height:"208"})}),"\n",(0,a.jsxs)(n.admonition,{type:"note",children:[(0,a.jsx)(n.p,{children:"Decoration itself does not modify the original expression. You can check it by pasting the result into any text-editor"}),(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-mathematica",children:'(*VB[*)(1)(*,*)(*"1:eJxTTM..."*)(*]VB*)  - 1 \n'})})]}),"\n",(0,a.jsx)(n.h3,{id:"examples-in-action",children:"Examples in action"}),"\n",(0,a.jsxs)(n.p,{children:["A navigation gizmo ",(0,a.jsx)(n.a,{href:"/frontend/Command%20palette",children:"snippet"})," is made using this technique combined with dynamically generated symbols wrapped in ",(0,a.jsx)(n.a,{href:"/frontend/Reference/Interpreter/Offload",children:"Offload"})]}),"\n",(0,a.jsx)(i,{children:(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{src:t(86260).c+"",width:"800",height:"538"})})}),"\n",(0,a.jsx)(n.h3,{id:"using-javascript",children:"Using Javascript"}),"\n",(0,a.jsxs)(n.p,{children:["One can use a full power of Web to decorate your symbols. For example, create a ",(0,a.jsx)(n.a,{href:"/frontend/Cell%20types/Javascript",children:"Javascript"})," cell with a following content"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:".js\n\ncore.SmileyDecorator = async (args, env) => {\n  const canvas = document.createElement('canvas');\n  canvas.width = 50;\n  canvas.height = 50;\n  const ctx = canvas.getContext('2d');\n\n  // Draw a cool smiley face adjusted to fit the smaller canvas\n  ctx.beginPath();\n  ctx.arc(25, 25, 20, 0, Math.PI * 2, true); // Outer circle\n  ctx.moveTo(35, 25);\n  ctx.arc(25, 25, 8, 0, Math.PI, false);  // Mouth (clockwise)\n  ctx.moveTo(22, 20);\n  ctx.arc(20, 20, 2, 0, Math.PI * 2, true);  // Left eye\n  ctx.moveTo(32, 20);\n  ctx.arc(30, 20, 2, 0, Math.PI * 2, true);  // Right eye\n  ctx.stroke();\n\n  env.element.appendChild(canvas);\n}\n"})}),"\n",(0,a.jsxs)(n.p,{children:["The given function will append a canvas with an image to provided element in the context of its execution. To provide this context and force Wolfram Kernel to execute this symbol on ",(0,a.jsx)(n.a,{href:"/frontend/Advanced/Frontend%20interpretation/WLJS%20Functions",children:"the frontend"})," use can use ",(0,a.jsx)(n.a,{href:"/frontend/Reference/Frontend%20Objects/CreateFrontEndObject",children:"CreateFrontEndObject"})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-mathematica",metastring:'title="test"',children:"SmileyDecorator[] // CreateFrontEndObject\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{src:t(88911).c+"",width:"1040",height:"230"})}),"\n",(0,a.jsx)(n.p,{children:"Great! Now we can apply similar trick we used earlier"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-mathematica",children:"Interpretation[SmileyDecorator[] // CreateFrontEndObject, 1]\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{src:t(25736).c+"",width:"1026",height:"294"})}),"\n",(0,a.jsx)(n.h3,{id:"magic-joystick",children:"Magic joystick"}),"\n",(0,a.jsx)(n.p,{children:"We can cover from a user all event bindings and etc providing a symbol, which can be used in dynamics"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-mathematica",children:"createDynamic2DSymbol[] := Module[{symbol = {0,0}}, With[{\n\teventObject = InputJoystick[],\n\thelper = InputJoystick`IntegrationHelper[][Function[xy, symbol = xy]]\n},\n\tEventHandler[eventObject, helper];\n\tInterpretation[eventObject, Offload[symbol]]\n]]\n"})}),"\n",(0,a.jsx)(n.p,{children:"Then you can create an instance by evaluating this in a new cell"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-mathematica",children:"createDynamic2DSymbol[]\n"})}),"\n",(0,a.jsx)(n.p,{children:"An output is a joystick"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{src:t(20996).c+"",width:"966",height:"176"})}),"\n",(0,a.jsxs)(n.p,{children:["Then we need to ",(0,a.jsx)(n.strong,{children:"cut it and paste into the cell below"})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-mathematica",children:"Plot[Sin[x], {x, -5Pi, 5Pi}, Epilog->{\n  Disk[ (* paste it here *), 0.5]\n}]\n"})}),"\n",(0,a.jsxs)(n.p,{children:["Once evaluated you will get a controllable ",(0,a.jsx)(n.a,{href:"/frontend/Reference/Graphics/Disk",children:"Disk"})," by a joystick inside an input cell"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{src:t(41086).c+"",width:"800",height:"397"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.em,{children:"a but more optimized version"})}),"\n",(0,a.jsxs)(i,{children:[(0,a.jsx)(n.p,{children:"here we will not spawn additional wrapper widget, the result is the same, but less overhead to an editor"}),(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-mathematica",children:'createDynamic2DSymbol[] := Module[{symbol = {0,0}}, With[{\n\teventObject = InputJoystick[],\n\thelper = InputJoystick`IntegrationHelper[][Function[xy, symbol = xy]]\n},\n\tEventHandler[eventObject, helper];\n\tWith[{display = eventObject[[1]]["View"] // CreateFrontEndObject},\n\t\tInterpretation[display, Offload[symbol]]\n\t]\n]]\n'})}),(0,a.jsxs)(n.p,{children:["Why? See reference on ",(0,a.jsx)(n.a,{href:"/frontend/Reference/Decorations/Interpretation",children:"Interpretation"})]})]}),"\n",(0,a.jsx)(n.h2,{id:"permanent",children:"Permanent"}),"\n",(0,a.jsxs)(n.p,{children:["In this way ",(0,a.jsx)(n.a,{href:"/frontend/Reference/Graphics/RGBColor",children:"RGBColor"}),", most mathematical equations, ",(0,a.jsx)(n.a,{href:"/frontend/Reference/Graphics/",children:"Graphics"})," and other visual sugar was implemented. For example"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-mathematica",children:"Now\nRed\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{src:t(6900).c+"",width:"1046",height:"158"})}),"\n",(0,a.jsx)(n.h3,{id:"interpretationbox",children:"InterpretationBox"}),"\n",(0,a.jsxs)(n.p,{children:["This is a low-level symbol used in ",(0,a.jsx)(n.a,{href:"/frontend/Reference/Decorations/Interpretation",children:"Interpretation"}),", however from temporal decoration we can make a permanent one by defining ",(0,a.jsx)(n.a,{href:"/frontend/Reference/Decorations/MakeBoxes",children:"MakeBoxes"})," for ",(0,a.jsx)(n.a,{href:"/frontend/Reference/Decorations/StandardForm",children:"StandardForm"})]}),"\n",(0,a.jsx)(n.h4,{id:"morse-code",children:"Morse code"}),"\n",(0,a.jsxs)(n.p,{children:["Let us make a syntax sugar for a Morse code! Our ",(0,a.jsx)(n.strong,{children:"special symbol"})," for representing a code will be"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-mathematica",children:"morse[code_String]\n"})}),"\n",(0,a.jsx)(n.p,{children:"We need conversion rules"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-mathematica",children:'morseTable = {"a" -> ".- ", "b" -> "-... ", "c" -> "-.-. ", \n   "d" -> "-.. ", "e" -> ". ", "f" -> "..-. ", "g" -> "--. ", \n   "h" -> ".... ", "i" -> ".. ", "j" -> ".--- ", "k" -> "-.- ", \n   "l" -> ".-.. ", "m" -> "-- ", "n" -> "-. ", "o" -> "--- ", \n   "p" -> ".--. ", "q" -> "--.- ", "r" -> ".-. ", "s" -> "... ", \n   "t" -> "- ", "u" -> "..- ", "v" -> "...- ", "w" -> ".-- ", \n   "x" -> "-..- ", "y" -> "-.-- ", "z" -> "--.. ", " " -> "/ "};\n\nToMorseCode[text_String] := StringReplace[\n  ToLowerCase[text], morseTable]\n\nmorse /: TextString[morse[s_String]] := s\n'})}),"\n",(0,a.jsx)(n.p,{children:"Now let us make boxes for it"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-mathematica",children:"morse /: MakeBoxes[m: morse[s_], f:StandardForm] := With[{\n\tcode = ToMorseCode[s]\n},\n\tInterpretationBox[MakeBoxes[Style[code, 18, Italic], f], m]\n]\n"})}),"\n",(0,a.jsx)(n.p,{children:"Let's see the result"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-mathematica",children:'morse["SOS"]\n'})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{src:t(91320).c+"",width:"1376",height:"178"})}),"\n",(0,a.jsx)(n.p,{children:"We can perform back transformation, since underneath we still have an original expression"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{src:t(9968).c+"",width:"1438",height:"162"})}),"\n",(0,a.jsx)(n.p,{children:"As the last thing - we can make it audible"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-mathematica",children:'silence = Table[0, {t,0,40Pi,0.1}];\ndot = Table[Sin[5 t], {t,0,40Pi,0.1}];\ndash = Join[dot, dot];\n\n\nmorse /: Play[morse[t_String]] := With[{\n  code = ToMorseCode[t]\n},\n   Join @@ (Switch[#, \n    ".",\n      Join[dot, silence],\n    "-",\n      Join[dash, silence],\n    _,\n      Join[silence, silence]\n  ] &/@ StringSplit[code, ""]) // ListPlay\n]\n'})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-mathematica",children:'morse["SOS"] // Play \n'})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{src:t(3828).c+"",width:"1386",height:"192"})}),"\n",(0,a.jsx)(n.h4,{id:"md5-representation",children:"MD5 representation"}),"\n",(0,a.jsx)(n.p,{children:"Another example, that shows how to produce graphical output."}),"\n",(0,a.jsx)(n.p,{children:"Here we will visually encrypt any Wolfram Language expression using our custom wrapper symbol for it"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-mathematica",metastring:'title="this is our symbol"',children:"secret[any_]\n"})}),"\n",(0,a.jsx)(n.p,{children:"Now let's define a representation for it"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-mathematica",children:'secret /: MakeBoxes[s: secret[expr_], StandardForm] := With[{hash = Hash[expr, "MD5", "ByteArray"] // Normal},\n  With[{im = Image[Partition[Partition[hash, 3],2], ImageSize->50] // CreateFrontEndObject},\n    InterpretationBox[MakeBoxes[im, StandardForm], s]\n  ]\n]\n'})}),"\n",(0,a.jsx)(n.admonition,{type:"warning",children:(0,a.jsxs)(n.p,{children:["Apply ",(0,a.jsx)(n.a,{href:"/frontend/Reference/Frontend%20Objects/CreateFrontEndObject",children:"CreateFrontEndObject"})," on anything related to ",(0,a.jsx)(n.code,{children:"Graphics"}),", ",(0,a.jsx)(n.code,{children:"Image"})," or ",(0,a.jsx)(n.code,{children:"Graphics3D"})," due to a bug in our box system implementation."]})}),"\n",(0,a.jsx)(n.p,{children:"And we also need a function to reveal the secret"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-mathematica",children:"reveal[secret[expr_]] := expr\n"})}),"\n",(0,a.jsx)(n.p,{children:"Here is a demonstration"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-mathematica",children:"secret[Plot[x, {x,0,1}]]\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{src:t(5572).c+"",width:"1986",height:"238"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.em,{children:"then simply copy and paste this symbol to a new cell and apply revel function"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{src:t(48896).c+"",width:"2052",height:"682"})}),"\n",(0,a.jsx)(n.h3,{id:"arrangesummarybox",children:"ArrangeSummaryBox"}),"\n",(0,a.jsx)(n.p,{children:"There is another built-in function for helping representing objects"}),"\n",(0,a.jsx)(n.admonition,{type:"tip",children:(0,a.jsxs)(n.p,{children:["If you want to hear more about OOP-like objects in Wolfram Language - check this guide ",(0,a.jsx)(n.a,{href:"/frontend/Advanced/Objects/Creating%20new%20type",children:"Creating new type"})]})}),"\n",(0,a.jsx)(n.p,{children:"For example, we have some symbol with information inside its arguments"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-mathematica",children:'specialSymbol[<|"Date"->Now, "Color"->Red, "State"->True|>]\n'})}),"\n",(0,a.jsx)(n.p,{children:"Let us decorate it"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-mathematica",children:'specialSymbol /: MakeBoxes[obj : specialSymbol[asc_Association], StandardForm] := \n    Module[{above, below},\n        above = { \n          {BoxForm`SummaryItem[{"Date: ", asc["Date"]}]},\n          {BoxForm`SummaryItem[{"Color: ", asc["Color"]}]}, \n          {BoxForm`SummaryItem[{"State: ", asc["State"]}]}\n        };\n\n        BoxForm`ArrangeSummaryBox[\n           specialSymbol, (* head *)\n           obj,      (* interpretation *)\n           None,     (* icon, use None if not needed *)\n           (* above and below must be in a format suitable for Grid or Column *)\n           above,    (* always shown content *)\n           Null (* expandable content. Currently not supported!*)\n        ]\n    ];\n'})}),"\n",(0,a.jsx)(n.p,{children:"The result will look like this"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-mathematica",children:'specialSymbol[<|"Date"->Now, "Color"->Red, "State"->True|>]\n'})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{src:t(89484).c+"",width:"1794",height:"216"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.em,{children:"This symbol is still valid for evaluation, what you see is only a syntax sugar"})}),"\n",(0,a.jsxs)(n.p,{children:["One can add an icon to it, which we can make dependent on ",(0,a.jsx)(n.code,{children:'"Color"'})," field"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-mathematica",children:'specialSymbol /: MakeBoxes[obj : specialSymbol[asc_Association], StandardForm] := \n    Module[{above, below, icon},\n        above = { \n          {BoxForm`SummaryItem[{"Date: ", asc["Date"]}]},\n          {BoxForm`SummaryItem[{"Color: ", asc["Color"]}]}, \n          {BoxForm`SummaryItem[{"State: ", asc["State"]}]}\n        };\n\n        With[{icon = Graphics[{\n          Lighter[asc["Color"]], Disk[{0,0}, 1],\n          asc["Color"], Disk[{0,0}, 0.8]\n        }, \n          ImageSize->{50,50}, \n          ImagePadding->None, \n          Controls->False,\n          PlotRange->{{-1,1},{-1,1}}\n        ]},\n\n          BoxForm`ArrangeSummaryBox[\n             specialSymbol, (* head *)\n             obj,      (* interpretation *)\n             icon,     (* icon, use None if not needed *)\n             (* above and below must be in a format suitable for Grid or Column *)\n             above,    (* always shown content *)\n             Null (* expandable content. Currently not supported!*)\n          ]\n        ]\n    ];\n'})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{src:t(99956).c+"",width:"1782",height:"232"})}),"\n",(0,a.jsx)(n.admonition,{type:"info",children:(0,a.jsxs)(n.p,{children:["See how to make ",(0,a.jsx)(n.strong,{children:"dynamic decorations"})," in a guide ",(0,a.jsx)(n.a,{href:"/frontend/Advanced/Objects/Creating%20new%20type",children:"Creating new type"})]})}),"\n",(0,a.jsx)(n.h3,{id:"viewbox",children:"ViewBox"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsxs)(n.em,{children:["a low-level building block used by ",(0,a.jsx)(n.code,{children:"Interpretation"}),", ",(0,a.jsx)(n.code,{children:"InterpretationBox"}),", ",(0,a.jsx)(n.code,{children:"ArrangeSummaryBox"})," and others"]})}),"\n",(0,a.jsxs)(n.p,{children:["It gives you full control over a decoration. One can event listen events from there and ",(0,a.jsx)(n.a,{href:"/frontend/Reference/Decorations/ViewBox#From%20Wolfram%20Kernel",children:"mutate"})," inner and outer content of it remotely"]}),"\n",(0,a.jsx)(n.h4,{id:"simple-example",children:"Simple example"}),"\n",(0,a.jsx)(n.p,{children:"The easiest way of using it to replace an expression with graphics, image or something similar"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-mathematica",children:"boxObject[_Real]\n"})}),"\n",(0,a.jsx)(n.p,{children:"Lets decorate it"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-mathematica",children:"boxObject /: MakeBoxes[boxObject[s_], StandardForm] := With[{\n  g = Graphics[{Blue, Disk[{0,0},1], Opacity[0.5], Red,Disk[{0,0},s]}, ImageSize->80, Controls->False, ImagePadding->None]\n},\n  ViewBox[boxObject[s], g // CreateFrontEndObject]\n]\n"})}),"\n",(0,a.jsxs)(n.admonition,{type:"warning",children:[(0,a.jsxs)(n.p,{children:["Normal expressions won't work as a display value in ",(0,a.jsx)(n.code,{children:"ViewBox"}),". They have to be defined as ",(0,a.jsx)(n.a,{href:"/frontend/Advanced/Frontend%20interpretation/WLJS%20Functions",children:"WLJS Functions"})," (graphics functions already implemented and do not count) or wrapped into ",(0,a.jsx)(n.a,{href:"/frontend/Reference/Frontend%20Objects/CreateFrontEndObject",children:"CreateFrontEndObject"}),"."]}),(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"If you still want to pass normal wolfram expression and not to care about anything"}),", please, consider to use ",(0,a.jsx)(n.a,{href:"#InterpretationBox",children:"InterpretationBox"}),"."]}),(0,a.jsxs)(n.p,{children:["Another reason why ",(0,a.jsx)(n.code,{children:"CreateFrontEndObject"})," is used: what you write as a second argument will end up as a text in a cell. Therefore to avoid such an overhead for an editor if any large graphics data passed we need to pass only the reference to frontend objects storage generated by this (",(0,a.jsx)(n.code,{children:"CreateFrontEndObject"}),") function."]})]}),"\n",(0,a.jsx)(n.p,{children:"The result will depend on a value inside an argument of our symbol"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-mathematica",children:"Table[boxObject[i], {i,3}]\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{src:t(92575).c+"",width:"792",height:"130"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"There is still a valid expression inside in InputForm"})}),"\n",(0,a.jsx)(n.p,{children:"We can make frontend beep, once widget has been destroyed"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-mathematica",children:'boxObject /: MakeBoxes[boxObject[s_], StandardForm] := With[{\n  g = Graphics[{Blue, Disk[{0,0},1], Opacity[0.5], Red,Disk[{0,0},s]}, ImageSize->80, Controls->False, ImagePadding->None],\n  uid = CreateUUID[]\n},\n  EventHandler[uid, {"Destroy"->Beep}];\n  \n  ViewBox[boxObject[s], g // CreateFrontEndObject, "Event"->uid]\n]\n'})}),"\n",(0,a.jsx)(n.h4,{id:"external-decorators",children:"External decorators"}),"\n",(0,a.jsxs)(n.p,{children:["One can also use Javascript to decorate a symbol. We will rewrite our ",(0,a.jsx)(n.code,{children:"MakeBoxes"})," for it"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-mathematica",children:"boxObject /: MakeBoxes[boxObject[s_], StandardForm] := With[{},\n  ViewBox[boxObject[s], customDecorator[s]]\n]\n"})}),"\n",(0,a.jsx)(n.admonition,{type:"info",children:(0,a.jsxs)(n.p,{children:["Here we did not use ",(0,a.jsx)(n.a,{href:"/frontend/Reference/Frontend%20Objects/CreateFrontEndObject",children:"CreateFrontEndObject"}),", since our decorator function is plain and does not require much space."]})}),"\n",(0,a.jsx)(n.p,{children:"Now it comes to a decorator function, which modifies provided DOM element in the current context (where it was called)"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-javascript",children:".js\n\ncore.customDecorator = async (args, env) => {\n\tconst state = await interpretate(args[0], env);\n\tconst element = env.element;\n\n\telement.classList.add('flex', 'rounded-md', 'p-2');\n\telement.style.border = \"1px solid #999\";\n\telement.style.boxShadow = \"inset 0 2px 4px 0 rgb(0 30% 0 / 0.05)\";\n\n    element.style.transitionDuration = '0.8s';\n    element.style.transitionProperty = 'transform';\n\n    setTimeout(() => {\n      element.style.transform = \"rotate(360deg)\";\n    }, 100);\n\n\telement.innerText = state;\n}\n"})}),"\n",(0,a.jsx)(n.p,{children:"Let's check it"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-mathematica",children:"boxObject[33]\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{src:t(40215).c+"",width:"1050",height:"260"})}),"\n",(0,a.jsxs)(n.p,{children:["One cal also make it dynamic by defining a proper ",(0,a.jsx)(n.code,{children:".update"})," method for a ",(0,a.jsx)(n.code,{children:"customDecorator"})," (see ",(0,a.jsx)(n.a,{href:"/frontend/Advanced/Frontend%20interpretation/WLJS%20Functions",children:"WLJS Functions"}),")."]}),"\n",(0,a.jsx)(n.h2,{id:"deferred",children:"Deferred"}),"\n",(0,a.jsxs)(n.p,{children:["The major difference is that we create a decoration only, when the symbol appeared in the editor. For this we will construct a dummy ",(0,a.jsx)(n.a,{href:"/frontend/Reference/Decorations/ViewBox",children:"ViewBox"})," just to emit this event"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-mathematica",children:'dummy /: MakeBoxes[dummy[handler_], StandardForm] := With[{\n  uid = CreateUUID[]\n},\n  EventHandler[uid, {"Mounted" :> Function[marker,\n    With[{win = WindowObj[<|"Socket"->$Client|>]},\n      FrontSubmit[handler[marker, win], MetaMarker[marker], "Window"->win];\n    ]\n   ]\n  }];\n  \n  ViewBox[Null, Null, "Event"->uid]\n]\n'})}),"\n",(0,a.jsxs)(n.p,{children:["where ",(0,a.jsx)(n.code,{children:"handler"})," will be the function, which actually populates the instance of ",(0,a.jsx)(n.code,{children:"ViewBox"})," with a content. Let us show the simples example, where it will generate random shapes"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-mathematica",children:"handler[marker_String, win_] := With[{\n  g = With[{d = 2 Pi/RandomInteger[{2,16}]}, \n Graphics[\n  Table[{EdgeForm[Opacity[.6]], Hue[(-11 + q + 10 r)/72, 1, 1], \n    Polygon[{(8 - r) {Cos[d (q - 1)], \n        Sin[d (q - 1)]}, (8 - r) {Cos[d (q + 1)], \n        Sin[d (q + 1)]}, (10 - r) {Cos[d q], Sin[d q]}}]}, {r, 6}, {q,\n     12}], ImageSize->{50,50}, ImagePadding->None]]\n},\n  {PaneBox[], g // CreateFrontEndObject}\n]\n"})}),"\n",(0,a.jsx)(n.p,{children:"If you try to evaluate this"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-mathematica",children:"dummy[handler]\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{src:t(19032).c+"",width:"800",height:"150"})}),"\n",(0,a.jsxs)(n.p,{children:["Even if a widget (or symbol) got copied, It would still be a unique instance. Once a symbol has appeared in the editor a function ",(0,a.jsx)(n.code,{children:"handler"})," is called."]}),"\n",(0,a.jsx)(n.admonition,{type:"tip",children:(0,a.jsx)(n.p,{children:"Use deferred generation of decorations, if you need to differentiate between copies of the same symbol."})}),"\n",(0,a.jsx)(n.h3,{id:"state-preservation",children:"State preservation"}),"\n",(0,a.jsxs)(n.p,{children:["Where to store the state? The trick can be done using ",(0,a.jsx)(n.a,{href:"/frontend/Reference/Decorations/ViewBox#%60%60ViewBox%60InnerExpression%60%60",children:(0,a.jsx)(n.code,{children:"ViewBox`InnerExpression"})})," and keeping the data inside the cell."]}),"\n",(0,a.jsx)(n.p,{children:"Let us have an example with sliders"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-mathematica",children:'handler[state_String, marker_, window_] := Module[{\n\tobject = InputRange[0,1, 0.1, ToExpression[state]]\n},\n\tEventHandler[object, Function[value,\n       FrontSubmit[ViewBox`InnerExpression[ToString[value]], MetaMarker[marker], "Window"->window];\n    ]];\n  \n\n\t{PaneBox[], object[[1, "View"]] // CreateFrontEndObject}\n]\n\nslider /: MakeBoxes[slider[initial_:0.5], StandardForm] := With[{\n  uid = CreateUUID[]\n},\n  EventHandler[uid, {"Mounted" :> Function[marker,\n    With[{win = WindowObj[<|"Socket"->$Client|>]},\n\t  Then[FrontFetchAsync[ViewBox`InnerExpression[], MetaMarker[marker], "Window"->win], Function[payload,\n        FrontSubmit[handler[{payload}//Flatten//First, marker, win], MetaMarker[marker], "Window"->win];\n      ]]\n    ]\n   ]\n  }];\n  \n  ViewBox[initial, Null, "Event"->uid]\n]\n'})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.em,{children:"Try to evaluate this"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-mathematica",children:"slider[0.7]\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{src:t(79772).c+"",width:"1018",height:"236"})}),"\n",(0,a.jsx)(n.p,{children:"When you drag a slider, it updates the original value hidden under the decoration in the cell. If you copy and paste it, for each copy it will create the unique slider"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{src:t(63744).c+"",width:"1404",height:"252"})})]})}function h(e={}){const{wrapper:n}={...(0,r.M)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}},19032:(e,n,t)=>{t.d(n,{c:()=>a});const a=t.p+"assets/images/DeferredDeco-ezgif.com-speed-4b6999a40342e6c8187402f38318d0d3.gif"},41086:(e,n,t)=>{t.d(n,{c:()=>a});const a=t.p+"assets/images/Dragdjoy GIF speed-17ad6cd4b080bc27b37618c6832633d2.gif"},86260:(e,n,t)=>{t.d(n,{c:()=>a});const a=t.p+"assets/images/Screen Recording Apr 8 (3)-a5b564409586bc3434e3c63a91b22453.gif"},92575:(e,n,t)=>{t.d(n,{c:()=>a});const a=t.p+"assets/images/Screenshot 2024-05-01 at 16.02.59-7fe0c4dc4112ab597bc3aee2a9436816.png"},85080:(e,n,t)=>{t.d(n,{c:()=>a});const a=t.p+"assets/images/Screenshot 2024-05-02 at 23.06.10-2eb3b9ded2048a60a7166cf6775bc48e.png"},88911:(e,n,t)=>{t.d(n,{c:()=>a});const a=t.p+"assets/images/Screenshot 2024-05-02 at 23.24.27-adfb066de8e2d899235ef9c5b947d397.png"},25736:(e,n,t)=>{t.d(n,{c:()=>a});const a=t.p+"assets/images/Screenshot 2024-05-02 at 23.26.34-ccc351df5eb5cf9549f3e94867c7c854.png"},91320:(e,n,t)=>{t.d(n,{c:()=>a});const a=t.p+"assets/images/Screenshot 2024-05-03 at 22.31.12-c6b7cffc4238ab83ef3b19943f152dfa.png"},9968:(e,n,t)=>{t.d(n,{c:()=>a});const a=t.p+"assets/images/Screenshot 2024-05-03 at 22.32.11-f09cd015cba561fd1ce3b59626013956.png"},3828:(e,n,t)=>{t.d(n,{c:()=>a});const a=t.p+"assets/images/Screenshot 2024-05-03 at 22.33.28-51de85a82e61e1b0214b4f284cd4cdbc.png"},5572:(e,n,t)=>{t.d(n,{c:()=>a});const a=t.p+"assets/images/Screenshot 2024-05-03 at 22.49.27-b13838a08431e9ca24b5d2d522436604.png"},48896:(e,n,t)=>{t.d(n,{c:()=>a});const a=t.p+"assets/images/Screenshot 2024-05-03 at 22.50.34-1a6706b0e88a00ff5a7f7b3b658f11b6.png"},89484:(e,n,t)=>{t.d(n,{c:()=>a});const a=t.p+"assets/images/Screenshot 2024-05-04 at 12.48.32-d9ba3bb194dca907e1993b1841be0cc2.png"},99956:(e,n,t)=>{t.d(n,{c:()=>a});const a=t.p+"assets/images/Screenshot 2024-05-04 at 12.54.20-9cd7ca6a155128a4bde084dd91e9fa62.png"},20996:(e,n,t)=>{t.d(n,{c:()=>a});const a=t.p+"assets/images/Screenshot 2024-05-04 at 13.17.33-0664ae4de958428d56a92c22f2b70a20.png"},40215:(e,n,t)=>{t.d(n,{c:()=>a});const a=t.p+"assets/images/Screenshot 2024-05-04 at 13.47.06-da94f92fb10799b13e273665ece55e98.png"},6900:(e,n,t)=>{t.d(n,{c:()=>a});const a=t.p+"assets/images/Screenshot 2024-05-04 at 13.51.35-56bc5438506f31a5d363f62c53b0b535.png"},79772:(e,n,t)=>{t.d(n,{c:()=>a});const a=t.p+"assets/images/Screenshot 2024-05-12 at 14.02.19-92ee87fc410d7d076925cd1d57de8c2e.png"},63744:(e,n,t)=>{t.d(n,{c:()=>a});const a=t.p+"assets/images/Screenshot 2024-05-12 at 14.04.27-2aa4904f4f6a8ffe0dcfcd0cde931e7a.png"},4552:(e,n,t)=>{t.d(n,{I:()=>o,M:()=>s});var a=t(11504);const r={},i=a.createContext(r);function s(e){const n=a.useContext(i);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),a.createElement(i.Provider,{value:n},e.children)}}}]);