"use strict";(self.webpackChunkwlx_docs=self.webpackChunkwlx_docs||[]).push([[5825],{93516:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>s,metadata:()=>r,toc:()=>d});var i=t(17624),a=t(4552);const s={},l="Crypto text",r={id:"frontend/Advanced/Slides/crypto-text",title:"Crypto text",description:"Here we will create a component to make the following effect possible on a slide",source:"@site/docs/frontend/Advanced/Slides/crypto-text.md",sourceDirName:"frontend/Advanced/Slides",slug:"/frontend/Advanced/Slides/crypto-text",permalink:"/frontend/Advanced/Slides/crypto-text",draft:!1,unlisted:!1,tags:[],version:"current",lastUpdatedAt:171226241e4,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Components",permalink:"/frontend/Advanced/Slides/components"},next:{title:"Large tables of data",permalink:"/frontend/Advanced/Slides/tables"}},o={},d=[{value:"Handling text updates",id:"handling-text-updates",level:2},{value:"Crypto effect",id:"crypto-effect",level:2},{value:"Component approach",id:"component-approach",level:2}];function c(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,a.M)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"crypto-text",children:"Crypto text"}),"\n",(0,i.jsx)(n.p,{children:"Here we will create a component to make the following effect possible on a slide"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:t(22520).c+"",width:"800",height:"378"})}),"\n",(0,i.jsx)(n.p,{children:"It consists of two parts"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"WLX template"}),"\n",(0,i.jsx)(n.li,{children:"small Javascript function to efficiently update the text"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"handling-text-updates",children:"Handling text updates"}),"\n",(0,i.jsxs)(n.p,{children:["One could use ",(0,i.jsx)(n.a,{href:"/frontend/Reference/GUI/TextView",children:"TextView"})," or something similar, that automatically binds to Wolfram Language. However, if we have a lot of text or big paragraph it might break the line breaks and in general is a bit heavy then a single ",(0,i.jsx)(n.code,{children:"span"})," or ",(0,i.jsx)(n.code,{children:"div"})," in HTML tree."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",metastring:'title="cell 1"',children:".js\n//just to reduce getElementById requests\nconst hashTable = {};\n\ncore.UpdateTextField = async (args, env) => {\n  const uid = await interpretate(args[1], env);\n  const data = await interpretate(args[0], env);\n  if (uid in hashTable) {\n    hashTable[uid].innerText = data;\n  } else {\n    hashTable[uid] = document.getElementById(uid);\n    hashTable[uid].innerText = data;\n  }\n}\n"})}),"\n",(0,i.jsxs)(n.p,{children:["here we defined a function, that changes the text-content of a given HTML element found by a given ",(0,i.jsx)(n.code,{children:"ID"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-mathematica",children:"UpdateTextField[text_String, Id_String]\n"})}),"\n",(0,i.jsxs)(n.p,{children:["One can test it using ",(0,i.jsx)(n.a,{href:"/frontend/Cell%20types/HTML",children:"HTML"})," or ",(0,i.jsx)(n.a,{href:"/frontend/Cell%20types/WLX",children:"WLX"})," cells"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-html",metastring:'title="cell 1"',children:'.html\n<span id="someId">Text</span>\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-mathematica",metastring:'title="cell 2"',children:'UpdateTextField[RandomWord[], "someId"] // FrontSubmit\n'})}),"\n",(0,i.jsx)(n.h2,{id:"crypto-effect",children:"Crypto effect"}),"\n",(0,i.jsx)(n.p,{children:'The idea is to use Boltzmann weighted sampling function and pick up a letters from English alphabet. The original letter presented in the string will be "energetically" more favourable than the rest letters from the alphabet. The energy difference can be tuned by the statistical temperature T'}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-mathematica",metastring:'title="cell 2"',children:"CT`prop[T_] := Join[{Exp[(*FB[*)((1)(*,*)/(*,*)(2 T))(*]FB*)]},  (Exp[(*FB[*)((-1)(*,*)/(*,*)(2 T))(*]FB*)])&/@Range[26]]\n"})}),"\n",(0,i.jsx)(n.p,{children:"and we need to match the uppercases and lowercases"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-mathematica",metastring:'title="cell 3"',children:"CT`variants[c_] := If[LowerCaseQ[c], Join[{c}, Alphabet[]], Join[{c}, ToUpperCase/@Alphabet[]]]\n"})}),"\n",(0,i.jsx)(n.p,{children:"now let us test"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-mathematica",children:'RandomChoice[CT`prop[0.2] -> CT`variants[#]] &/@ StringSplit["Hello World", ""] // StringRiffle\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-mathematica",children:'"H w l l o   F o r l d"\n'})}),"\n",(0,i.jsx)(n.h2,{id:"component-approach",children:"Component approach"}),"\n",(0,i.jsx)(n.p,{children:"Now we can construct a sort of a wrapper function, that we can use at any text string"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-jsx",metastring:'title="cell 4"',children:'.wlx\n\nCryptoText[TextX_String, OptionsPattern[]] := With[{\n  UId = CreateUUID[], cell = ResultCell[], win = CurrentWindow[], \n  slide = EventClone[OptionValue["Slide"]], onStartEvent = OptionValue["OnStart"]\n},\n\n  Module[{\n\t  task, \n\t  crypted, \n\t  original, \n\t  temperature = 1.0, \n\t  mainTask, easeTask, \n\t  finished = False\n   },\n   \n    original = StringSplit[TextX, ""];\n    crypted = original;\n\n    EventHandler[slide, {\n      "Slide" -> Function[Null,\n        (* show first time -> start *)\n        \n        mainTask = SetInterval[\n          (crypted[[#]] = If[original[[#]] =!= " ", RandomChoice[CT`prop[temperature] -> CT`variants[original[[#]]]], original[[#]]]) &/@ RandomSample[Range[Length[original]]];\n          \n          FrontSubmit[UpdateTextField[StringRiffle[crypted, ""], UId], "Window"->win];\n      , 100];\n      \n      ],\n\n      onStartEvent -> Function[Null,\n        (* slowly morph into the original text *)\n        \n        With[{easeTask = SetInterval[temperature = temperature + 0.1(0.05 - temperature), 200]},\n          SetTimeout[\n            TaskRemove[easeTask];\n            TaskRemove[mainTask];\n          , 6000];\n        ];\n\n        EventRemove[slide];\n        finished = True;\n      ]\n    }];\n    \n\n    EventHandler[cell, {"Destroy"->Function[Null, \n      (* if a cell was removed *)\n      Print["Removed"];\n\n      If[finished, Return[]];\n\n      TaskRemove[mainTask];\n      EventRemove[slide];\n      \n    ]}];\n\n    <span style="font-family:monospace" id="{UId}"><TextX/></span>\n  ]\n]\n\nOptions[CryptoText] = {"OnStart"->"", "Slide"->""};\n'})}),"\n",(0,i.jsx)(n.p,{children:"The final function looks like this"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-mathematica",children:'CryptoText[text_String, "Slide"->slideEvent_String, "OnStart"->onStart_String] _String\n'})}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["It returns a DOM element ",(0,i.jsx)(n.code,{children:"span"})," with a unique Id."]}),"\n",(0,i.jsxs)(n.li,{children:["It assigns an event listener to ",(0,i.jsx)(n.code,{children:"slideEvent"}),", which is typically generated by ",(0,i.jsx)(n.a,{href:"/frontend/Reference/Slides/SlideEventListener",children:"SlideEventListener"})," and check if a slide was revealed."]}),"\n",(0,i.jsx)(n.li,{children:"If the last thing is true it starts to regenerate text-string and update the DOM element using an Id generated previously."}),"\n",(0,i.jsxs)(n.li,{children:["Once ",(0,i.jsx)(n.code,{children:"onStart"})," pattern was captured (can be a fragment event - see ",(0,i.jsx)(n.a,{href:"/frontend/Advanced/Slides/animations",children:"animations"}),"), it reduces the statistical temperature to the minimum (",(0,i.jsx)(n.code,{children:"easeTask"}),") and then stops the animation after some time"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"We can see it in action on the slide here"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-jsx",metastring:'title="cell 5"',children:'.slide\n\nJust an empty slide to trigger an event on the next one\n\n---\n\n# <CryptoText OnStart={"fragment-1"} Slide={"slide-1"}>Heading</CryptoText>\n\nThis is a body of the slide\n\n<CryptoText OnStart={"fragment-1"} Slide={"slide-1"}>Housework could be everyone\u2019s work, not just \u201cwomen\u2019s work\u201d. Why do women enable men to act oblivious to cleaning, grocery shopping, pet feeding, etc? Somehow when men live alone they figure out how to do all of those things all on their own. My friend\u2019s husband claimed he didn\u2019t know that sheets should be washed more than once a season. He said he didn\u2019t know one had to clean toilets. He assumed that since you flush toilets they clean themselves. She tried to get him to help but he did an awful job so she let him off the hook.</CryptoText>\n\n<br/>\n\n<CryptoText OnStart={"fragment-1"} Slide={"slide-1"}>Wouldn\u2019t it be better if she spent the time and energy to get him to do it right instead of letting him claim he is \u201cjust bad at it\u201d. My sons were raised to clean toilets and change their own sheets. Hopefully, in their future homes, the housework will be equally divided.</CryptoText>\n\n\n\nStop \x3c!-- .element: class="fragment" data-fragment-index="1" --\x3e\n\n<SlideEventListener Id={"slide-1"}/>\n\n'})}),"\n",(0,i.jsxs)(n.admonition,{type:"warning",children:[(0,i.jsx)(n.p,{children:"This effect will not work if a cell output is projected to another window, since Javascript cells are local and belongs to the original Notebook's window."}),(0,i.jsx)(n.p,{children:(0,i.jsxs)(n.em,{children:["Press ",(0,i.jsx)(n.code,{children:"f"})," on a slide to make it fullscreen"]})})]})]})}function h(e={}){const{wrapper:n}={...(0,a.M)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},22520:(e,n,t)=>{t.d(n,{c:()=>i});const i=t.p+"assets/images/Cryptic video to gif-b3db130558b38246328e3f5fdb6753d8.gif"},4552:(e,n,t)=>{t.d(n,{I:()=>r,M:()=>l});var i=t(11504);const a={},s=i.createContext(a);function l(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:l(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);