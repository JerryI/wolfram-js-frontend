<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.3.2">
<title data-rh="true">Bad Apple, but it‚Äôs Wolfram Language Plot | WLJS Notebook</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="http://127.0.0.1:20540/blog/2024/05/01/badapple"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Bad Apple, but it‚Äôs Wolfram Language Plot | WLJS Notebook"><meta data-rh="true" name="description" content="Bad üçé animation by Anira group originally based on ZUN)&#x27;s work for bullet shoot &#x27;em up game Touhou Project_ is remarkable cultural internet phenomenon often used for testing and demonstrating the features of some old hardware, algorithms, graphics systems  or other esoteric medium. And in general as an of art object -  Bad Apple shadow animation is just eye-catching and amazingly crafted piece ‚ú®. Not even mentioning hot pumping 16-bit flavoured tune and a beautiful voice of Nomico („ÅÆ„Åø„Åì)."><meta data-rh="true" property="og:description" content="Bad üçé animation by Anira group originally based on ZUN)&#x27;s work for bullet shoot &#x27;em up game Touhou Project_ is remarkable cultural internet phenomenon often used for testing and demonstrating the features of some old hardware, algorithms, graphics systems  or other esoteric medium. And in general as an of art object -  Bad Apple shadow animation is just eye-catching and amazingly crafted piece ‚ú®. Not even mentioning hot pumping 16-bit flavoured tune and a beautiful voice of Nomico („ÅÆ„Åø„Åì)."><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2024-05-01T00:00:00.000Z"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="http://127.0.0.1:20540/blog/2024/05/01/badapple"><link data-rh="true" rel="alternate" href="http://127.0.0.1:20540/blog/2024/05/01/badapple" hreflang="en"><link data-rh="true" rel="alternate" href="http://127.0.0.1:20540/blog/2024/05/01/badapple" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"http://127.0.0.1:20540/blog/2024/05/01/badapple","mainEntityOfPage":"http://127.0.0.1:20540/blog/2024/05/01/badapple","url":"http://127.0.0.1:20540/blog/2024/05/01/badapple","headline":"Bad Apple, but it‚Äôs Wolfram Language Plot","name":"Bad Apple, but it‚Äôs Wolfram Language Plot","description":"Bad üçé animation by Anira group originally based on ZUN)'s work for bullet shoot 'em up game Touhou Project_ is remarkable cultural internet phenomenon often used for testing and demonstrating the features of some old hardware, algorithms, graphics systems  or other esoteric medium. And in general as an of art object -  Bad Apple shadow animation is just eye-catching and amazingly crafted piece ‚ú®. Not even mentioning hot pumping 16-bit flavoured tune and a beautiful voice of Nomico („ÅÆ„Åø„Åì).","datePublished":"2024-05-01T00:00:00.000Z","author":[],"keywords":[],"isPartOf":{"@type":"Blog","@id":"http://127.0.0.1:20540/blog","name":"Blog title"}}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="WLJS Notebook RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="WLJS Notebook Atom Feed">





<script type="module" src="/wljs-interpreter/src/interpreter.js"></script>
<script type="module" src="/wljs-interpreter/src/core.js"></script>
<script type="module" src="/wljs-cells/src/module.js"></script>
<script type="module" src="/wljs-editor/dist/kernel.js"></script>
<script type="module" src="/wljs-editor/src/boxes.js"></script>
<script type="module" src="/wljs-editor/src/objects.js"></script>
<script type="module" src="/wljs-sharedlib-d3/dist/kernel.js"></script>
<script type="module" src="/wljs-graphics-d3/dist/kernel.js"></script>
<script type="module" src="/wljs-graphics3d-threejs/dist/kernel.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.b45d54da.css">
<script src="/assets/js/runtime~main.86ffa257.js" defer="defer"></script>
<script src="/assets/js/main.be5c6ac2.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo3.svg" alt="WLJS Notebook" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo2.svg" alt="WLJS Notebook" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">WLJS</b></a><a class="navbar__item navbar__link" href="/">Documentation</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/JerryI/wolfram-js-frontend/discussions" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link" style="border:0;border-radius:6px">Discuss</a><a href="https://github.com/JerryI/wolfram-js-frontend" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input id="search_input_react" type="search" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">All our posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2024/05/13/json-llm">Converting JSON crystal data to Graphics using AI Assistant</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/blog/2024/05/01/badapple">Bad Apple, but it‚Äôs Wolfram Language Plot</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2024/04/24/dynamic-env">Dynamic color and opacity implementation</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2024/04/22/gauge">Dynamic gauge</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/spider">Procedural spider animation</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/image-trace">Image tracing and animation</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/imageraster">Image and Raster were implemented!</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/rtx-intro">Realtime path-tracing</a></li></ul></nav></aside><main class="col col--7"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_xvU1" itemprop="headline">Bad Apple, but it‚Äôs Wolfram Language Plot</h2><div class="container_iJTo margin-vert--md"><time datetime="2024-05-01T00:00:00.000Z" itemprop="datePublished"></time> ¬∑ <!-- -->10 min read</div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><p><a href="https://www.youtube.com/watch?v=FtutLA63Cp8" target="_blank" rel="noopener noreferrer">Bad üçé</a> animation by Anira group originally based on <a href="https://en.wikipedia.org/wiki/ZUN_(video_game_developer)" target="_blank" rel="noopener noreferrer">ZUN</a>&#x27;s work for bullet shoot &#x27;em up game <em>Touhou Project</em> is remarkable cultural internet phenomenon often used for testing and demonstrating the features of some old hardware, algorithms, graphics systems  or other esoteric medium. And in general as an of art object -  Bad Apple <em>shadow animation</em> is just eye-catching and amazingly crafted piece ‚ú®. Not even mentioning hot pumping 16-bit flavoured tune and a beautiful voice of Nomico („ÅÆ„Åø„Åì).</p>
<p>I (me @JerryI) have seen it many times popping up still in 2024, even as a <a href="https://www.youtube.com/watch?v=2Ni13dnAbSA" target="_blank" rel="noopener noreferrer">Fluid Simulation</a> and have been questioning myself why not anyone to try to implement it lively using some scientific software like Jupyter or Matlab or Wolfram Language and a standard plot function? It could fun</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Spoiler</summary><div><div class="collapsibleContent_i85q"><iframe width="100%" height="315" src="https://www.youtube.com/embed/QOuVV9nTras?si=vKT4GGCdY94ZHDOm" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin"></iframe></div></div></details>
<p>Today we will learn how to render this animation in real-time using WLJS Notebook and a single <code>Line</code> function.</p>
<blockquote>
<p>Open WLJS Notebook and create a new notebook üìí</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="one-line-to-tell-a-story">One line to tell a story<a href="#one-line-to-tell-a-story" class="hash-link" aria-label="Direct link to One line to tell a story" title="Direct link to One line to tell a story">‚Äã</a></h2>
<p>What is the most basic thing people try to do, when open Mathematica or WLJS Notebook for the first time? I believe it must be <code>Plot</code></p>
<div class="language-mathematica codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mathematica codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Plot</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">BesselJ</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> z</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">z</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<main id="frontend-editor" class="main-container styles-container-editor"><div id="frontend-editor-content" class="group-container"><div></div></div></main>
<p>The idea would be to transform each frame of a video to a single line path. Similar to a <em>one line art</em>. The approach is not new and <a href="https://www.wolfram.com/mathematica/new-in-10/enhanced-graphs-and-networks/continuous-line-drawing.html" target="_blank" rel="noopener noreferrer">was published</a> by Wolfram Research as a fun example in Mathematica 10.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="handling-video-frames">Handling video frames<a href="#handling-video-frames" class="hash-link" aria-label="Direct link to Handling video frames" title="Direct link to Handling video frames">‚Äã</a></h3>
<p>Firstly, obtain a video file of Bad Apple animation somehow and <strong>directly drop it to any input cell.</strong> It will upload a file and will provide a reference to it. Modify the tail of expression to explicitly tell Wolfram Kernel to extract video frames</p>
<div style="filter:none" class="language-mathematica codeBlockContainer_node_modules-@docusaurus-theme-classic-lib-theme-CodeBlock-Container-styles-module theme-code-block"><div class="codeBlockContent_node_modules-@docusaurus-theme-classic-lib-theme-CodeBlock-Content-styles-module"><pre tabindex="0" class="prism-code language-mathematica codeBlock_node_modules-@docusaurus-theme-classic-lib-theme-CodeBlock-Content-styles-module thin-scrollbar" style="color:rgb(57, 58, 52);background-color:rgb(246, 248, 250)"><code class="codeBlockLines_node_modules-@docusaurus-theme-classic-lib-theme-CodeBlock-Content-styles-module"></code></pre></div></div>
<p>Let us try our methods on 500th frame</p>
<div class="language-mathematica codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mathematica codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">video</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">500</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">//</span><span class="token plain"> Thumbnail</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/assets/images/Screenshot 2024-06-01 at 20.55.29-8b68b8dc059cd9cbfc1741a4e0b276d5.png" width="1346" height="282" class="img_ev3q">
You can <strong>directly copy and paste this image from the output cell</strong> to a new input cell and wrap some function over it (like on a video at the end of the post). Since in this story I am limited to my markdown editor, for the demonstration purposes I will use a dedicated variable</p>
<div class="language-mathematica codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mathematica codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">img </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> video</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">500</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">//</span><span class="token plain"> Thumbnail</span><span class="token operator" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>It comes handy here that Bad Apple relies on <em>shadow</em> animation style, so we can easily convert any image to a grid of <code>1</code> and <code>0</code></p>
<div class="language-mathematica codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mathematica codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">img </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> img </span><span class="token operator" style="color:#393A34">//</span><span class="token plain"> ImageAdjust </span><span class="token operator" style="color:#393A34">//</span><span class="token plain"> Binarize</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/assets/images/Screenshot 2024-06-01 at 21.00.13-a7b837136cc9be06e34fd7444cc8aa22.png" width="1330" height="266" class="img_ev3q">
Imagine if all dark parts will be filled with one long line path zig-zagging over it. This is somewhat easy to do if we know the positions of all dark pixels</p>
<div class="language-mathematica codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mathematica codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pos </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> PixelValuePositions</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">img</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/assets/images/Screenshot 2024-06-01 at 21.03.19-43485b4097667e3c5b3ac10f8a91b6bf.png" width="1344" height="330" class="img_ev3q"></p>
<p>Great. Thanks to a giant standard library of Wolfram Language, there is a complete solution for optimizing the path to cover all dark pixels</p>
<div class="language-mathematica codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mathematica codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">length</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> path</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> FindShortestTour</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">pos</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Here we do not need <code>length</code>, but only actual <code>path</code> which contains indexes of points from <code>pos</code> connected in order to form the shortest route though all dark pixels. Let&#x27;s see how it looks</p>
<div class="language-mathematica codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mathematica codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ListLinePlot</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">pos</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/assets/images/path-test-1-291f9860fe63bf921e971fcc3ed8af36.svg" width="370" height="239" class="img_ev3q"></p>
<p>It feels a bit too dense for my taste, let&#x27;s average it a bit</p>
<div class="language-mathematica codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mathematica codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ListLinePlot</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">MovingAverage</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">pos</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/assets/images/test-path-4-aae6207fe4915abc87291ff022010d5e.svg" width="370" height="239" class="img_ev3q"></p>
<p>This already feels more interesting and has a vibe of <em>one line art</em>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="batch-processing">Batch processing<a href="#batch-processing" class="hash-link" aria-label="Direct link to Batch processing" title="Direct link to Batch processing">‚Äã</a></h3>
<p>Now we need to apply this set of steps to every frame. One can organize it like this</p>
<div class="language-mathematica codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mathematica codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">trace</span><span class="token punctuation" style="color:#393A34">[</span><span class="token blank regex" style="color:#36acaa">frame_</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">Module</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">img</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pos</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> path</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        img </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ImageAdjust</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">frame </span><span class="token operator" style="color:#393A34">//</span><span class="token plain"> Thumbnail </span><span class="token operator" style="color:#393A34">//</span><span class="token plain"> Binarize</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        pos </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> PixelValuePositions</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">img</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">//</span><span class="token plain">N</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">(* get numerical *)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        path </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> FindShortestTour</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">pos</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        MovingAverage</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">pos</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>And to track progress, we can also add a bar</p>
<div class="language-mathematica codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">optional</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mathematica codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">progressBar</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">max_Real </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> max_Integer</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> LeakyModule</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	progress </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	bar</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	increment</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	timer </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> AbsoluteTime</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	bar </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> CellPrint</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">ToString</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		Graphics</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">			LightBlue</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Rectangle</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">			Green</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Rectangle</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">Offload</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> progress </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ImagePadding</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token keyword" style="color:#00009f">None</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Controls</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ImageSize</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#36acaa">400</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">30</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> StandardForm</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;After&quot;</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain">EvaluationCell</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token comment" style="color:#999988;font-style:italic">(* throttling *)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	increment</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">value_Real </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> value_Integer</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">If</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">AbsoluteTime</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> timer </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		timer </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> AbsoluteTime</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		progress </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> value </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> max </span><span class="token operator" style="color:#393A34">//</span><span class="token plain"> N</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		</span><span class="token keyword" style="color:#00009f">If</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">progress </span><span class="token operator" style="color:#393A34">&gt;=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.99</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">			ClearAll</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">increment</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">			Delete</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">bar</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	increment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>I would not recommend to apply it right on all frames from the video, since an algorithm is extremely easy to implement, but it comes with performance costs.</p>
<p>We can test it on the 100 frames (skipping black frames from the beginning)</p>
<div class="language-mathematica codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mathematica codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">bar </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> progressBar</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">frames </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> MapIndexed</span><span class="token punctuation" style="color:#393A34">[</span><span class="token keyword" style="color:#00009f">Function</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">frame</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> index</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  bar</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">index </span><span class="token operator" style="color:#393A34">//</span><span class="token plain"> First</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  trace</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">frame</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Take</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">Drop</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">video</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">200</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><em>It will take a while... Try lower resolution resizing each frame with <code>ImageResize</code> function</em></p>
<p>On my Mac Air M1 a single frame took <code>~3</code> seconds to complete. In the end I left my laptop for next 5 hours and went for a walk in the forest to process an entire Bad Apple video, but you don&#x27;t have to üòâ the final result is at the end of this post.</p>
<p>An algorithm can definitely be improved in many ways, but for demonstration purposes I will leave it as it is for now. This is <strong>the most naive approach</strong> to one line stylised images.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="animation">Animation<a href="#animation" class="hash-link" aria-label="Direct link to Animation" title="Direct link to Animation">‚Äã</a></h2>
<p>How to animate this sequence of lines <strong>right in the notebook</strong>? We do not want to cheat and use rasterized images. In Wolfram Mathematica, one can apply a simple <code>animate</code> function, however, dynamics in WLJS Notebook built differently: only low-level graphics primitives support dynamic evaluation, i.e.</p>
<div class="language-mathematica codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">cell 1</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mathematica codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">currentFrame </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> frames </span><span class="token operator" style="color:#393A34">//</span><span class="token plain"> First</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Graphics</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">Line</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">currentFrame </span><span class="token operator" style="color:#393A34">//</span><span class="token plain"> Offload</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> TransitionType</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token keyword" style="color:#00009f">None</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>*it is important to disable any tween-ing function by <code>TransitionType-&gt;None</code>, otherwise it will try to interpolate between frames, which is not good for our style *</p>
<p>Now if we change <code>currentFrame</code> symbol, <strong>a line will be redrawn using new data automatically</strong>. For example one can assign it to a slider</p>
<div class="language-mathematica codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">cell 2</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mathematica codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">EventHandler</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">InputRange</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Length</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">frames</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">Function</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">index</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	currentFrame </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> frames</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">index</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/assets/images/test-gif-demo-ezgif.com-optimize-eca3553355b167a02a1b5fff10f4678a.gif" width="800" height="377" class="img_ev3q"></p>
<p>How to make it animated automatically? There are several ways</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="using-timers">Using timers<a href="#using-timers" class="hash-link" aria-label="Direct link to Using timers" title="Direct link to Using timers">‚Äã</a></h3>
<p>The first thing coming to head is just to set a timer instead of a slider</p>
<div class="language-mathematica codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mathematica codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">index </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">task </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> SetInterval</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	currentFrame </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> frames</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">index</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	index</span><span class="token operator" style="color:#393A34">+</span><span class="token operator" style="color:#393A34">+</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token keyword" style="color:#00009f">If</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">index </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> Length</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">frames</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> TaskRemove</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">task</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1000</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">30.0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>It is suitable for most tasks, however for faster rates it might not keep up with the rest of the system. It also is not synchronized with a window refresh rate defined by a video engine.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="using-browsers-repaint-cycle">Using browser&#x27;s repaint cycle<a href="#using-browsers-repaint-cycle" class="hash-link" aria-label="Direct link to Using browser&#x27;s repaint cycle" title="Direct link to Using browser&#x27;s repaint cycle">‚Äã</a></h3>
<p>This is almost 1:1 copy of Javascript&#x27;s <code>requestAnimationFrame</code> method. We need to assign an event handler and a special function, that will fire an event to update the frame</p>
<div class="language-mathematica codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">cell 1</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mathematica codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">currentFrame </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> frames </span><span class="token operator" style="color:#393A34">//</span><span class="token plain"> First</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">index </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EventHandler</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;frame&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">Function</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">Null</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	currentFrame </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> frames</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">index</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	index</span><span class="token operator" style="color:#393A34">+</span><span class="token operator" style="color:#393A34">+</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token keyword" style="color:#00009f">If</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">index </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> Length</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">frames</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> index </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">;</span><span class="token plain">	</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Graphics</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	Line</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">currentFrame </span><span class="token operator" style="color:#393A34">//</span><span class="token plain"> Offload</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	AnimationFrameListener</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">currentFrame </span><span class="token operator" style="color:#393A34">//</span><span class="token plain"> Offload</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Event&quot;</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token string" style="color:#e3116c">&quot;frame&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> TransitionType</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token keyword" style="color:#00009f">None</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Here <code>AnimationFrameListener</code> checks if <code>currentFrame</code> is changing, and then requests an animation from a browser. On the next repaint cycle it will fire <code>frame</code> event, which updates <code>currentFrame</code> and the cycle repeats.</p>
<p>As a drawback, we cannot really control the speed, since it goes as fast as our system can go peaking at the refresh rate of a browser (60 - 120 FPS depending on the system).</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-slow-down-the-animation">How to slow down the animation<a href="#how-to-slow-down-the-animation" class="hash-link" aria-label="Direct link to How to slow down the animation" title="Direct link to How to slow down the animation">‚Äã</a></h4>
<p>We can skip frames to roughly match the frame-rate of a video. For this we need to check the passed time between <code>frame</code> event calls and skip the call if needed</p>
<div class="language-mathematica codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mathematica codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">currentFrame </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> frames </span><span class="token operator" style="color:#393A34">//</span><span class="token plain"> First</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">time </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> AbsoluteTime</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">index </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dummy </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EventHandler</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;frame&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">Function</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">Null</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token keyword" style="color:#00009f">If</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">AbsoluteTime</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> time </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">40.0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">(* 40FPS lol *)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		currentFrame </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> frames</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">index</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		index</span><span class="token operator" style="color:#393A34">+</span><span class="token operator" style="color:#393A34">+</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		</span><span class="token keyword" style="color:#00009f">If</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">index </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> Length</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">frames</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> index </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		time </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> 	AbsoluteTime</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		dummy </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">(* just to kick a listener *)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Graphics</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	Line</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">currentFrame </span><span class="token operator" style="color:#393A34">//</span><span class="token plain"> Offload</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	AnimationFrameListener</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">currentFrame </span><span class="token operator" style="color:#393A34">//</span><span class="token plain"> Offload</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Event&quot;</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token string" style="color:#e3116c">&quot;frame&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	AnimationFrameListener</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">dummy </span><span class="token operator" style="color:#393A34">//</span><span class="token plain"> Offload</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Event&quot;</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token string" style="color:#e3116c">&quot;frame&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> TransitionType</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token keyword" style="color:#00009f">None</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="optimizations">Optimizations<a href="#optimizations" class="hash-link" aria-label="Direct link to Optimizations" title="Direct link to Optimizations">‚Äã</a></h3>
<p>To improve the performance, we can apply several tricks</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="numericarray">NumericArray<a href="#numericarray" class="hash-link" aria-label="Direct link to NumericArray" title="Direct link to NumericArray">‚Äã</a></h4>
<p>Wolfram is a symbolic programming language, therefore even an array of numbers can become a higher-order specie. To explicitly tell a interpreter that there is no other things inside expect real or integer numbers (and will not be) we can wrap each frame into</p>
<div class="language-mathematica codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mathematica codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">frames </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> NumericArray </span><span class="token operator" style="color:#393A34">/@</span><span class="token plain"> frames</span><span class="token operator" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>It will also speed up the frontend.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="skip-points">Skip points<a href="#skip-points" class="hash-link" aria-label="Direct link to Skip points" title="Direct link to Skip points">‚Äã</a></h4>
<p>Since there is anyway a moving average filter applied, we do not need all points</p>
<div class="language-mathematica codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mathematica codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">frames </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> frames</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">All</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">;</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">;</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">(* take every 2nd *)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="final-video">Final video<a href="#final-video" class="hash-link" aria-label="Direct link to Final video" title="Direct link to Final video">‚Äã</a></h2>
<p>Here is the final result recorded in real-time (except the intro part)</p>
<iframe width="100%" height="315" src="https://www.youtube.com/embed/QOuVV9nTras?si=vKT4GGCdY94ZHDOm" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin"></iframe>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="bonus">Bonus<a href="#bonus" class="hash-link" aria-label="Direct link to Bonus" title="Direct link to Bonus">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="iconic-mathematicas-colors-and-axes">Iconic Mathematica&#x27;s colors and axes<a href="#iconic-mathematicas-colors-and-axes" class="hash-link" aria-label="Direct link to Iconic Mathematica&#x27;s colors and axes" title="Direct link to Iconic Mathematica&#x27;s colors and axes">‚Äã</a></h3>
<p>This is 97&#x27;s set in <code>ColorData</code>, which gives this typical blue-ish color of any Wolfram Language plot. We can add it to our <code>Graphics</code> symbol as well as typical x- and y-axis</p>
<div class="language-mathematica codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mathematica codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Graphics</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	ColorData</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">97</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	Line</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">currentFrame </span><span class="token operator" style="color:#393A34">//</span><span class="token plain"> Offload</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Axes</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> TransitionType</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token keyword" style="color:#00009f">None</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/assets/images/true-plot-f0d8787303dd822bb7573614e742a476.svg" width="370" height="244" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="audio">Audio<a href="#audio" class="hash-link" aria-label="Direct link to Audio" title="Direct link to Audio">‚Äã</a></h3>
<p>An audio can be extracted from a video file directly and played in the notebook</p>
<div class="language-mathematica codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mathematica codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">audio </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> VideoExtractTracks</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	Import</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">FileNameJoin</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;attachments&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Touhou - Bad Apple.mp4&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;Audio&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,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BN0V0+lIgAABAgQIECBAgAABAgQIECBAgAABAkUQEHQXYRXMgQABAgQIECBAgAABAgQIECBAgAABAgQqFhB0V0ynIwECBAgQIECAAAECBAgQIECAAAECBAgUQUDQXYRVMAcCBAgQIECAAAECBAgQIECAAAECBAgQqFhA0F0xnY4ECBAgQIAAAQIECBAgQIAAAQIECBAgUAQBQXcRVsEcCBAgQIAAAQIECBAgQIAAAQIECBAgQKBiAUF3xXQ6EiBAgAABAgQIECBAgAABAgQIECBAgEARBATdRVgFcyBAgAABAgQIECBAgAABAgQIECBAgACBigUE3RXT6UiAAAECBAgQIECAAAECBAgQIECAAAECRRAQdBdhFcyBAAECBAgQIECAAAECBAgQIECAAAECBCoWEHRXTKcjAQIECBAgQIAAAQIECBAgQIAAAQIECBRBQNBdhFUwBwIECBAgQIAAAQIECBAgQIAAAQIECBCoWEDQXTGdjgQIECBAgAABAgQIECBAgAABAgQIECBQBAFBdxFWwRwIECBAgAABAgQIECBAgAABAgQIECBAoGIBQXfFdDoSIECAAAECBAgQIECAAAECBAgQIECAQBEEBN1FWAVzIECAAAECBAgQIECAAAECBAgQIECAAIGKBQTdFdPpSIAAAQIECBAgQIAAAQIECBAgQIAAAQJFEBB0F2EVzIEAAQIECBAgQIAAAQIECBAgQIAAAQIEKhYQdFdMpyMBAgQIECBAgAABAgQIECBAgAABAgQIFEFA0F2EVTAHAgQIECBAgAABAgQIECBAgAABAgQIEKhYQNBdMZ2OBAgQIECAAAECBAgQIECAAAECBAgQIFAEAUF3EVbBHAgQIECAAAECBAgQIECAAAECBAgQIECgYgFBd8V0OhIgQIAAAQIECBAgQIAAAQIECBAgQIBAEQT+H7/NAl8LX8ivAAAAAElFTkSuQmCC" width="1466" height="104" class="img_ev3q"></p>
<p>A completely different story is how to synchronize it with our animation. We need a stream player and manually feed audio chunks to it.</p>
<p>There is a low-level primitive <code>PCMPlayer</code>, which can be used for this purpose. So let us create an audio buffer first and assign it to a player</p>
<div class="language-mathematica codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">cell</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mathematica codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">audioBuffer </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PCMPlayer</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">audioBuffer </span><span class="token operator" style="color:#393A34">//</span><span class="token plain"> Offload</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;SignedInteger16&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> SampleRate</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token number" style="color:#36acaa">44100</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Now we need to provide PCM encoded data to it by chunks. Then we have to figure out how it is distributed over our frames</p>
<div class="language-mathematica codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mathematica codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">audioData </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> AudioData</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">audio</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;SignedInteger16&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">//</span><span class="token plain"> First</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chunks </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> NumericArray </span><span class="token operator" style="color:#393A34">/@</span><span class="token plain"> Partition</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">audioData</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Round</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">Length</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">audioData</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">Length</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">video</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1000</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Here we added extra <code>1000</code> samples to slightly overlap the portions to account the time needed for sending them and processing (just in case). You may increase it you hear some crackling noise.</p>
<p>Then we drop first 100, since we skipped them in frames</p>
<div class="language-mathematica codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mathematica codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">chunks </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Drop</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">chunks</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>and modify our animation function accordingly. For the simplicity we will go with <a href="#Using%20timer">Using timer</a></p>
<div class="language-mathematica codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mathematica codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">index </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">task </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> SetInterval</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	currentFrame </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> frames</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">index</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	audioBuffer </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> chunks</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">index</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	index</span><span class="token operator" style="color:#393A34">+</span><span class="token operator" style="color:#393A34">+</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token keyword" style="color:#00009f">If</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">index </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> Length</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">frames</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> TaskRemove</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">task</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1000</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">30.0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Full code</strong> for the animation with sound is available below</p>
<div class="language-mathematica codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">processing</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mathematica codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">video </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Import</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">FileNameJoin</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;attachments&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Touhou - Bad Apple.mp4&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;ImageList&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> All</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">audio </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> VideoExtractTracks</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">Import</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">FileNameJoin</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;attachments&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Touhou - Bad Apple.mp4&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;Audio&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trace</span><span class="token punctuation" style="color:#393A34">[</span><span class="token blank regex" style="color:#36acaa">frame_</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">Module</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">img</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pos</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> path</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        img </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ImageAdjust</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">frame </span><span class="token operator" style="color:#393A34">//</span><span class="token plain"> Thumbnail </span><span class="token operator" style="color:#393A34">//</span><span class="token plain"> Binarize</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        pos </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> PixelValuePositions</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">img</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">//</span><span class="token plain">N</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        path </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> FindShortestTour</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">pos</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        MovingAverage</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">pos</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">(* optional *)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">progressBar</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">max_Real </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> max_Integer</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> LeakyModule</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	progress </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	bar</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	increment</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	timer </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> AbsoluteTime</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	bar </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> CellPrint</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">ToString</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		Graphics</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">			LightBlue</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Rectangle</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">			Green</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Rectangle</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">Offload</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> progress </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ImagePadding</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token keyword" style="color:#00009f">None</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Controls</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ImageSize</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#36acaa">400</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">30</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> StandardForm</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;After&quot;</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain">EvaluationCell</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token comment" style="color:#999988;font-style:italic">(* throttling *)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	increment</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">value_Real </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> value_Integer</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">If</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">AbsoluteTime</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> timer </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		timer </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> AbsoluteTime</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		progress </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> value </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> max </span><span class="token operator" style="color:#393A34">//</span><span class="token plain"> N</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		</span><span class="token keyword" style="color:#00009f">If</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">progress </span><span class="token operator" style="color:#393A34">&gt;=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.99</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">			ClearAll</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">increment</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">			Delete</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">bar</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	increment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bar </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> progressBar</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">frames </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> MapIndexed</span><span class="token punctuation" style="color:#393A34">[</span><span class="token keyword" style="color:#00009f">Function</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">frame</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> index</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  bar</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">index </span><span class="token operator" style="color:#393A34">//</span><span class="token plain"> First</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  trace</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">frame</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Take</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">Drop</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">video</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">frames </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> NumericArray </span><span class="token operator" style="color:#393A34">/@</span><span class="token plain"> frames</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">audioData </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> AudioData</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">audio</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;SignedInteger16&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">//</span><span class="token plain"> First</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chunks </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> NumericArray </span><span class="token operator" style="color:#393A34">/@</span><span class="token plain"> Partition</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">audioData</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Round</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">Length</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">audioData</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">Length</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">video</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1000</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chunks </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Drop</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">chunks</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-mathematica codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">animating</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mathematica codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">audioBuffer </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">currentFrame </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> frames </span><span class="token operator" style="color:#393A34">//</span><span class="token plain"> First</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PCMPlayer</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">audioBuffer </span><span class="token operator" style="color:#393A34">//</span><span class="token plain"> Offload</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;SignedInteger16&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> SampleRate</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token number" style="color:#36acaa">44100</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Graphics</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	RGBColor</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0.368417</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.506779</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.709798</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	Line</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">currentFrame </span><span class="token operator" style="color:#393A34">//</span><span class="token plain"> Offload</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> TransitionType</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token keyword" style="color:#00009f">None</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Axes</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-mathematica codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">animating</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mathematica codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">index </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">task </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> SetInterval</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	currentFrame </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> frames</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">index</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	audioBuffer </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> chunks</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">index</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	index</span><span class="token operator" style="color:#393A34">+</span><span class="token operator" style="color:#393A34">+</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token keyword" style="color:#00009f">If</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">index </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> Length</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">frames</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> TaskRemove</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">task</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1000</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">30.0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>See you next time ü™Ñ</p>
<p>Cheers,
Kirill</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/2024/05/13/json-llm"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">Converting JSON crystal data to Graphics using AI Assistant</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/2024/04/24/dynamic-env"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Dynamic color and opacity implementation</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#one-line-to-tell-a-story" class="table-of-contents__link toc-highlight">One line to tell a story</a><ul><li><a href="#handling-video-frames" class="table-of-contents__link toc-highlight">Handling video frames</a></li><li><a href="#batch-processing" class="table-of-contents__link toc-highlight">Batch processing</a></li></ul></li><li><a href="#animation" class="table-of-contents__link toc-highlight">Animation</a><ul><li><a href="#using-timers" class="table-of-contents__link toc-highlight">Using timers</a></li><li><a href="#using-browsers-repaint-cycle" class="table-of-contents__link toc-highlight">Using browser&#39;s repaint cycle</a></li><li><a href="#optimizations" class="table-of-contents__link toc-highlight">Optimizations</a></li></ul></li><li><a href="#final-video" class="table-of-contents__link toc-highlight">Final video</a></li><li><a href="#bonus" class="table-of-contents__link toc-highlight">Bonus</a><ul><li><a href="#iconic-mathematicas-colors-and-axes" class="table-of-contents__link toc-highlight">Iconic Mathematica&#39;s colors and axes</a></li><li><a href="#audio" class="table-of-contents__link toc-highlight">Audio</a></li></ul></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://t.me/+PBotB9UJw-hiZDEy" target="_blank" rel="noopener noreferrer" class="footer__link-item">Telegram<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">WLJS Notebook Project is open-source and licensed under GPL3</div></div></div></footer></div>
</body>
</html>